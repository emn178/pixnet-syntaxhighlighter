<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <link rel="stylesheet" type="text/css" href="http://vote.pixplug.in/stylesheets/reset.css?1332756723">
  <link rel="stylesheet" type="text/css" href="//flickr-embed-tool.appmarket.pixplug.in/static/css/style.css?v=1">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script src="//appmarket.pixplug.in/pixnet-js-addon/libs/js/jquery.query.min.js"></script>
  <script src="//libs.pixfs.net/porthole/20110504/porthole.min.js" type="text/javascript"></script>
  <script src="src/pixnet-syntaxhighlighter.js"></script>
  <script type="text/javascript">
    var windowProxy;
    $(document).ready(function() {
      var proxy_url = $.query.get('proxy_url') + '?addon_id=' + $.query.get('addon_id') + '&pToken=' + $.query.get('pToken');
      windowProxy = new Porthole.WindowProxy( proxy_url );

      $('#form-html-code').on('submit', function() {
        var language = $('language').val();
        var code = $('code').val();
        var data = createCodeBlock(language, code);
        var ret = $.query.get('addon_id') + "||PIXNET||" + data;
        windowProxy.postMessage(ret);
        return false;
      });
      
      $('#popup-cancel-btn').click(function() {
        var ret = $.query.get('addon_id') + "||PIXNET||";
        windowProxy.postMessage(ret);
        return false;
      });
    });
  </script>
</head>
<body>
  <form id="form-html-code">
    <div id="popup-body" class="popup-body">
      <div class="content">
        <table class="settings-table th-large" cellspacing="0">
          <tbody>
            <tr>
              <th><label for="language">程式語言</label></th>
              <td>
                <input class="input-style" name="language" id="language" / >
              </td>
            </tr>
            <tr>
              <th><label for="code">程式碼</label></th>
              <td>
                <textarea class="input-style input-textarea" rows="10" name="code" id="code"></textarea>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div id="popup-footer" class="popup-footer">
      <div id="popup-submit-box">
        <button type="submit" id="popup-submit-btn"><span>送出</span></button>
        <button type="button" id="popup-cancel-btn"><span>取消</span></button>
      </div>
    </div>
  </form>
</body>
</html>
